{% extends 'base.html' %}
{% block title %}Your Recovery Codes{% endblock %}

{% block content %}
<h3>Your Recovery Codes</h3>
<p>Keep these safe! Each code can be used once if you lose your authenticator app.</p>

<ul>
  {% for code in codes %}
    <li><strong>{{ code }}</strong></li>
  {% endfor %}
</ul>

{% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li>{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}

<form id="download-form" action="{% url 'download_recovery_codes' %}" method="post" style="margin-top: 20px;">
  {% csrf_token %}
  <button type="submit">Download as PDF</button>
</form>

{% if user.recovery_codes_downloaded %}
  <a href="{% url 'dashboard' %}" class="btn btn-primary" style="margin-top: 15px;">
    Proceed to Dashboard
  </a>
{% endif %}

<script>
document.getElementById("download-form").addEventListener("submit", function() {
  // Wait 1 seconds after clicking Download, then refresh the page
  setTimeout(() => {
    location.reload();
  }, 1000);
});
</script>
{% endblock %}

