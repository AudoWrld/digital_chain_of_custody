<!DOCTYPE html>
<html lang="en">
  <head>
    {% load static %}
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}ChainProof{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link
      rel="icon"
      type="image/png"
      href="{% static 'images/favicon.png' %}?v={{ STATIC_VERSION }}"
      sizes="64x64"
    />
    <link
      rel="icon"
      type="image/png"
      href="{% static 'images/favicon.png' %}?v={{ STATIC_VERSION }}"
      sizes="128x128"
    />
    <link
      rel="icon"
      type="image/png"
      href="{% static 'images/favicon-96x96.png' %}?v={{ STATIC_VERSION }}"
    />
    <link
      rel="icon"
      type="image/png"
      href="{% static 'images/favicon.ico' %}?v={{ STATIC_VERSION }}"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="{% static 'images/apple-touch-icon.png' %}?v={{ STATIC_VERSION }}"
    />
    <link
      rel="manifest"
      href="{% static 'site.json' %}?v={{ STATIC_VERSION }}"
    />
    <link rel="stylesheet" href="{% static 'css/base.css' %}?v={{ STATIC_VERSION }}" />
    {% block extra_css %}{% endblock %}
  </head>
  <body>
    <header class="header">
      <div class="header-left">
        <img src="{% static 'images/logo.png' %}" alt="Logo" class="logo" />
        <span class="brand-name">ChainProof</span>
      </div>
      <div class="user-info">
        <div class="user-details">
          <div class="user-name">{{ user.first_name }} {{ user.last_name }}</div>
          <div class="user-role">
            {% if user.is_superuser %}
            Admin
            {% else %}
            {{ user.get_role_display }}
            {% endif %}
          </div>
        </div>
        <div class="user-avatar">
          {% if user.profile_picture %}
          <img src="{{ user.profile_picture.url }}" alt="{{ user.get_full_name }}" class="user-avatar-img" />
          {% else %}
          {{ user.first_name.0 }}{{ user.last_name.0 }}
          {% endif %}
        </div>
        <a href="{% url 'accounts:logout' %}" class="logout-btn">
          <i class='bx bx-log-out'></i>
          <span>Logout</span>
        </a>
      </div>
    </header>

    <div class="main-wrapper">
      <aside class="sidebar">
        <div>
        {% if user.is_superuser %}
        <nav class="sidebar-section">
          <a href="{% url 'dashboard:dashboard' %}" class="sidebar-link {% if request.path == '/dashboard/' %}active{% endif %}">
            <i class='bx bx-home'></i>
            <span>Dashboard</span>
          </a>
          <a href="{% url 'cases:case_list' %}" class="sidebar-link {% if request.path == '/cases/' %}active{% endif %}">
            <i class='bx bx-briefcase'></i>
            <span>All Cases</span>
          </a>
          <a href="{% url 'evidence:all_evidence' %}" class="sidebar-link {% if request.path == '/evidence/all/' %}active{% endif %}">
            <i class='bx bx-archive'></i>
            <span>All Evidence</span>
          </a>
          <a href="{% url 'accounts:user_management' %}" class="sidebar-link {% if request.path == '/accounts/management/' %}active{% endif %}">
            <i class='bx bx-group'></i>
            <span>User Management</span>
          </a>
          <a href="{% url 'accounts:user_list' %}" class="sidebar-link {% if request.path == '/accounts/management/list/' %}active{% endif %}">
            <i class='bx bx-user-check'></i>
            <span>Role Assignment</span>
          </a>
          <a href="{% url 'accounts:view_profile' %}" class="sidebar-link {% if request.path == '/accounts/profile/' %}active{% endif %}">
            <i class='bx bx-user'></i>
            <span>My Profile</span>
          </a>
          <a href="#" class="sidebar-link help-toggle">
            <i class='bx bx-help-circle'></i>
            <span>Help</span>
          </a>
          <a href="{% url 'accounts:logout' %}" class="sidebar-link">
            <i class='bx bx-log-out'></i>
            <span>Logout</span>
          </a>
        </nav>
        
        {% elif user.role == 'regular_user' %}
        <nav class="sidebar-section">
          <a href="{% url 'dashboard:dashboard' %}" class="sidebar-link {% if request.path == '/dashboard/' %}active{% endif %}">
            <i class='bx bx-home'></i>
            <span>Dashboard</span>
          </a>
          <a href="{% url 'cases:create_case' %}" class="sidebar-link {% if request.path == '/cases/create/' %}active{% endif %}">
            <i class='bx bx-plus-circle'></i>
            <span>Create Case</span>
          </a>
          <a href="{% url 'cases:case_list' %}" class="sidebar-link {% if request.path == '/cases/' %}active{% endif %}">
            <i class='bx bx-briefcase'></i>
            <span>My Cases</span>
          </a>
          <a href="{% url 'evidence:my_evidence' %}" class="sidebar-link {% if request.path == '/evidence/my/' %}active{% endif %}">
            <i class='bx bx-archive'></i>
            <span>My Evidence</span>
          </a>
          <a href="#" class="sidebar-link">
            <i class='bx bx-file-blank'></i>
            <span>Case Reports</span>
          </a>
          <a href="{% url 'accounts:view_profile' %}" class="sidebar-link {% if request.path == '/accounts/profile/' %}active{% endif %}">
            <i class='bx bx-user'></i>
            <span>My Profile</span>
          </a>
          <a href="#" class="sidebar-link help-toggle">
            <i class='bx bx-help-circle'></i>
            <span>Help</span>
          </a>
          <a href="{% url 'accounts:logout' %}" class="sidebar-link">
            <i class='bx bx-log-out'></i>
            <span>Logout</span>
          </a>
        </nav>
        
        {% elif user.role == 'investigator' %}
        <nav class="sidebar-section">
          <a href="{% url 'dashboard:dashboard' %}" class="sidebar-link {% if request.path == '/dashboard/' %}active{% endif %}">
            <i class='bx bx-home'></i>
            <span>Dashboard</span>
          </a>
          <a href="{% url 'cases:assigned_cases' %}" class="sidebar-link {% if request.path == '/cases/assigned/' %}active{% endif %}">
            <i class='bx bx-briefcase'></i>
            <span>Assigned Cases</span>
          </a>
          <a href="{% url 'evidence:my_evidence' %}" class="sidebar-link {% if request.path == '/evidence/my/' %}active{% endif %}">
            <i class='bx bx-archive'></i>
            <span>Your Uploaded Evidence</span>
          </a>
          <a href="{% url 'accounts:view_profile' %}" class="sidebar-link {% if request.path == '/accounts/profile/' %}active{% endif %}">
            <i class='bx bx-user'></i>
            <span>My Profile</span>
          </a>
          <a href="#" class="sidebar-link help-toggle">
            <i class='bx bx-help-circle'></i>
            <span>Help</span>
          </a>
          <a href="{% url 'accounts:logout' %}" class="sidebar-link">
            <i class='bx bx-log-out'></i>
            <span>Logout</span>
          </a>
        </nav>
        
        {% elif user.role == 'analyst' %}
        <nav class="sidebar-section">
          <a href="{% url 'reports:dashboard' %}" class="sidebar-link {% if request.path == '/reports/dashboard/' %}active{% endif %}">
            <i class='bx bx-home'></i>
            <span>Dashboard</span>
          </a>
          <a href="{% url 'evidence:all_evidence' %}" class="sidebar-link {% if request.path == '/evidence/all/' %}active{% endif %}">
            <i class='bx bx-archive'></i>
            <span>All Evidence</span>
          </a>
          <a href="{% url 'cases:case_list' %}?stage=analysis" class="sidebar-link">
            <i class='bx bx-analyse'></i>
            <span>Evidence Analysis</span>
          </a>
          <a href="{% url 'cases:case_list' %}" class="sidebar-link">
            <i class='bx bx-check-shield'></i>
            <span>Integrity Verification</span>
          </a>
          <a href="{% url 'cases:case_list' %}" class="sidebar-link">
            <i class='bx bx-file-blank'></i>
            <span>Analysis Reports</span>
          </a>
          <a href="{% url 'accounts:view_profile' %}" class="sidebar-link {% if request.path == '/accounts/profile/' %}active{% endif %}">
            <i class='bx bx-user'></i>
            <span>My Profile</span>
          </a>
          <a href="#" class="sidebar-link help-toggle">
            <i class='bx bx-help-circle'></i>
            <span>Help</span>
          </a>
          <a href="{% url 'accounts:logout' %}" class="sidebar-link">
            <i class='bx bx-log-out'></i>
            <span>Logout</span>
          </a>
        </nav>
        
        {% elif user.role == 'custodian' %}
        <nav class="sidebar-section">
          <a href="{% url 'custody:dashboard' %}" class="sidebar-link {% if request.path == '/custody/dashboard/' %}active{% endif %}">
            <i class='bx bx-home'></i>
            <span>Dashboard</span>
          </a>
          <a href="{% url 'custody:evidence_inventory' %}" class="sidebar-link {% if request.path == '/custody/evidence/inventory/' %}active{% endif %}">
            <i class='bx bx-box'></i>
            <span>Evidence Inventory</span>
          </a>
          <a href="{% url 'custody:case_storages' %}" class="sidebar-link {% if request.path == '/custody/case-storages/' %}active{% endif %}">
            <i class='bx bx-hdd'></i>
            <span>Case Storages</span>
          </a>
          <a href="{% url 'accounts:view_profile' %}" class="sidebar-link {% if request.path == '/accounts/profile/' %}active{% endif %}">
            <i class='bx bx-user'></i>
            <span>My Profile</span>
          </a>
          <a href="#" class="sidebar-link help-toggle">
            <i class='bx bx-help-circle'></i>
            <span>Help</span>
          </a>
          <a href="{% url 'accounts:logout' %}" class="sidebar-link">
            <i class='bx bx-log-out'></i>
            <span>Logout</span>
          </a>
        </nav>
        
        {% elif user.role == 'auditor' %}
        <nav class="sidebar-section">
          <a href="{% url 'auditor:dashboard' %}" class="sidebar-link {% if request.path == '/auditor/' %}active{% endif %}">
            <i class='bx bx-home'></i>
            <span>Dashboard</span>
          </a>
          <a href="{% url 'auditor:audit_logs' %}" class="sidebar-link {% if '/auditor/audit-logs/' in request.path %}active{% endif %}">
            <i class='bx bx-list-check'></i>
            <span>Audit Logs</span>
          </a>
          <a href="{% url 'auditor:chain_of_custody' %}" class="sidebar-link {% if '/auditor/chain-of-custody/' in request.path %}active{% endif %}">
            <i class='bx bx-transfer'></i>
            <span>Chain of Custody Reports</span>
          </a>
          <a href="{% url 'auditor:integrity_check' %}" class="sidebar-link {% if '/auditor/integrity-check/' in request.path %}active{% endif %}">
            <i class='bx bx-check-shield'></i>
            <span>Integrity Checks</span>
          </a>
          <a href="{% url 'accounts:view_profile' %}" class="sidebar-link {% if request.path == '/accounts/profile/' %}active{% endif %}">
            <i class='bx bx-user'></i>
            <span>My Profile</span>
          </a>
          <a href="#" class="sidebar-link help-toggle">
            <i class='bx bx-help-circle'></i>
            <span>Help</span>
          </a>
          <a href="{% url 'accounts:logout' %}" class="sidebar-link">
            <i class='bx bx-log-out'></i>
            <span>Logout</span>
          </a>
        </nav>
        {% endif %}
        </div>

        <div class="sidebar-footer">
          <div class="sidebar-footer-text">
            <div class="sidebar-footer-title">ChainProof</div>
            Securing Evidence Integrity Since 2026
          </div>
        </div>
      </aside>

      <main class="content-area">
        {% if messages %}
        <div class="messages">
          {% for message in messages %}
          <div class="message message-{{ message.tags }}" data-message-type="{{ message.tags }}">
            <div class="message-icon">
              {% if message.tags == 'success' %}
              <i class='bx bx-check-circle'></i>
              {% elif message.tags == 'error' %}
              <i class='bx bx-x-circle'></i>
              {% elif message.tags == 'warning' %}
              <i class='bx bx-error'></i>
              {% else %}
              <i class='bx bx-info-circle'></i>
              {% endif %}
            </div>
            <div class="message-content">{{ message }}</div>
            <button class="message-close" onclick="this.parentElement.remove()">
              <i class='bx bx-x'></i>
            </button>
          </div>
          {% endfor %}
        </div>
        {% endif %}

        {% block content %}
        {% endblock %}
      </main>

      {% include 'partials/help.html' %}
    </div>
    </div>
  </body>
</html>
