{% extends 'base.html' %}
{% load static %}

{% block title %}Analyze Evidence - {{ evidence.description }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/evidence/analyze_evidence.css' %}?v={{ STATIC_VERSION }}">
{% endblock %}

{% block content %}
<div class="analyze-page-container">
    <nav class="analyze-breadcrumb">
        <a href="{% url 'reports:dashboard' %}">Dashboard</a>
        <span class="analyze-breadcrumb-separator">/</span>
        <a href="{% url 'cases:view_case' evidence.case.case_id %}">Case {{ evidence.case.case_id }}</a>
        <span class="analyze-breadcrumb-separator">/</span>
        <a href="{% url 'evidence:view' evidence.id %}">Evidence #{{ evidence.id }}</a>
        <span class="analyze-breadcrumb-separator">/</span>
        <span class="analyze-breadcrumb-current">Analyze</span>
    </nav>

    <div class="analyze-alert">
        <i class='bx bx-info-circle'></i>
        <div class="analyze-alert-text">
            <strong>Analyst View:</strong> Analyze evidence, add findings, and verify integrity. Once submitted, analysis cannot be modified.
        </div>
    </div>

    <div class="analyze-summary-card">
        <div class="analyze-summary-header">
            <i class='bx bx-file-alt'></i>
            <h2 class="analyze-summary-title">Evidence Summary</h2>
        </div>
        <table class="analyze-summary-table">
            <tr>
                <th>Description</th>
                <td>{{ evidence.description }}</td>
            </tr>
            <tr>
                <th>Original Filename</th>
                <td>{{ evidence.original_filename }}</td>
            </tr>
            <tr>
                <th>SHA-256 Hash</th>
                <td><span class="analyze-summary-hash">{{ evidence.sha256_hash }}</span></td>
            </tr>
            <tr>
                <th>Media Type</th>
                <td>{{ evidence.get_media_type_display }}</td>
            </tr>
            <tr>
                <th>Case</th>
                <td><a href="{% url 'cases:view_case' evidence.case.case_id %}">{{ evidence.case.case_id }}</a></td>
            </tr>
            <tr>
                <th>Uploaded By</th>
                <td>{{ evidence.uploaded_by.get_full_name|default:evidence.uploaded_by.username }}</td>
            </tr>
        </table>
    </div>

    <div class="analyze-form-card">
        <div class="analyze-form-header">
            <i class='bx bx-clipboard'></i>
            <h2 class="analyze-form-title">Analysis Report</h2>
        </div>
        <div class="analyze-form-body">
            <form method="post">
                {% csrf_token %}
                
                <div class="analyze-form-group">
                    <label for="notes" class="analyze-form-label">Analysis Notes</label>
                    <textarea 
                        class="analyze-form-textarea" 
                        id="notes" 
                        name="notes" 
                        rows="5" 
                        placeholder="Enter your analysis notes..."
                        required
                    ></textarea>
                </div>
                
                <div class="analyze-form-group">
                    <label for="findings" class="analyze-form-label">Findings</label>
                    <textarea 
                        class="analyze-form-textarea" 
                        id="findings" 
                        name="findings" 
                        rows="5" 
                        placeholder="Enter your findings..."
                        required
                    ></textarea>
                </div>
                
                <div class="analyze-form-actions">
                    <button type="submit" class="analyze-submit-btn">
                        <i class='bx bx-send'></i>
                        Submit Analysis
                    </button>
                    <a href="{% url 'evidence:view' evidence.id %}" class="analyze-cancel-btn">
                        <i class='bx bx-x'></i>
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
